<html>
  <head>
  <style>
      body {margin: 0; overflow:hidden;}
      content {background-color: #000; display: grid; height: 100%; grid-template-columns: 50% 50%; grid-template-rows: 33% 33% 33%;  }
      footer {position: absolute; bottom: 0; left: 0;}
  </style>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <content id="videos">
    </content>
    <footer>
      <button onclick="javascript:location.reload()">Reload</button>
    </footer>
    <script>
    var selectedVideo = null;
    var cams = [
        "https://video-auth1.iol.pt/beachcam/carcavelos/chunks.m3u8",
        "https://video-auth1.iol.pt/beachcam/bcmafraribeira/chunks.m3u8",
        "https://video-auth1.iol.pt/beachcam/praiaguinchosul/chunks.m3u8",
        "https://video-auth1.iol.pt/beachcam/costacaparicacds/chunks.m3u8",
        "https://video-auth1.iol.pt/beachcam/saopedroestoria/chunks.m3u8",
        "https://video-auth1.iol.pt/beachcam/lagide/chunks.m3u8",
    ]
    var videos = []
    function loadVideo(videoId, url) {
        
        if (selectedVideo && selectedVideo !== videoId) {
          return;
        }
        var container = document.getElementById("videos");
        var video = document.createElement('video');
        container.appendChild(video)
        width = video.parentElement.clientWidth;
        height = video.parentElement.clientHeight;
        if (!selectedVideo){ 
          width = width / 2;
          height = height / 3;
        }
        video.setAttribute('width', width);
        video.setAttribute('height', height);
        video.setAttribute('id', videoId);
        video.muted ="muted";
        var hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
        hls.on(Hls.Events.MEDIA_ATTACHED,function() {
            video.play();
        });
        video.onclick = function () {
            if (selectedVideo) {
              selectedVideo = null;
            } else {
              selectedVideo = this.id;
            }
            loadVideos();
        }
        videos.push(hls)
        
    }
    function loadVideos() {
      unloadVideos();
      cams.forEach((url, i) => {
        loadVideo("video" + i, url);
      });
      
    }
    function unloadVideos() {
      videos.forEach((hls, i) => {
        hls.destroy()
      });
      videos = [];
      var container = document.getElementById("videos")
      container.innerHTML = ''
      ;
    }
    loadVideos();
    </script>
  </body>
</html>
